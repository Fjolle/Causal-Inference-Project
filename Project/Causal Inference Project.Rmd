---
title: "A deeper look at Uber's surge pricing model based on temperature levels"
author: "Fjolle Gjonbalaj"
output: html_document
---

Around 10 years ago, in San Francisco, CA, a company named UberCap started operating by enabling riders to hail a car with a
smart phone. Since then, the company has extended its operation in 65 countries and more than 700 cities around the world (1).Whether you are doing grocery shopping or visiting a new city, the uber app is a quick and convenient way to connect you with nearby drivers. All the rider needs to do is create an account with just an email address and a phone number. Once that step is done, you click on the app and enter the destination, check for nearby drivers and the price for the ride, confirm your pickup location and wait for your driver to show up.(2)  In 2014 Uber has announced its operation in Moscow, and today it has a presence in 16 cities in Russia.(3)  Provided whether conditions in Russia tend to be rather extreme with temperature levels significantly below freezing during winter to very high temperatures in the summer. Because of that, I thought it might be of interest to know whether or not temperature level matters when it comes to pricing of uber rides. Weather condition is not the only factor that affects surge pricing for uber. For this reason, I control for multiple covariates in the data set that would have an effect on pricing schemes. The first variable I control for is the time of the day. Since uber operates based on the demand for drivers and the supply of drivers, it is intuitive to think that during rush hour demand will exceed supply. When that happens it is natural for prices to increase also.(4) Uber charges more if it thinks you are willing to pay more (5).The second variable I control for is trip time. The longer the trip, the higher the price changed to the uber rider. The third covariate I control for is trip type.  “Uber” stands for a range of services available within the Uber app. Some of the uber services provided are UberX, UberXL, UberSELECT, UberBLACK, and many more.(6) Depending which one of these uber services you request, you will be changed a higher or a lower price per ride. I create an indicator variable that equals 1 if the uber ride requested is an UberX, and 0 otherwise. This allows me to control for the variable and cap its impact that it has on the overall uber prices. The fifth variable I control for is city. The price for requesting an uber in Saint Petersburg would be a lot different than an uber requested in the rural areas of Russia.Hence, depending on the city uber prices can be significantly different, and hence we need to control for this. Another variable I control for is distance. This relates to the control variable trip time. The longer the distance travelled, the higher the price changed to the uber rider. Since we want to isolate the effect of temperature on prices, we do not want distance to cause any endogeneity, and hence we control for it. The sixth variable I control for is the exchange rate. Since uber is a US company, the daily exchange rate between Russian ruble and the American dollar, will also affect the prices charged on uber rides in Russia. 





sources: 
(1):https://www.cnbc.com/2019/11/08/top-ride-sharing-apps-in-europe-asia-south-america-africa-and-usa.html
(2) https://www.uber.com/us/en/ride/how-it-works/
(3) https://www.theverge.com/2017/7/13/15963754/uber-yandex-merger-russia
(4) https://www.thepennyhoarder.com/save-money/beat-uber-surge-pricing/
(5) https://www.forbes.com/sites/nicolemartin1/2019/03/30/uber-charges-more-if-they-think-youre-willing-to-pay-more/?sh=536a77987365
(6) https://www.ridester.com/uberx-vs-uber/




```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r, warning=FALSE, include=FALSE, echo=FALSE}
library(rddensity)
library(tidyverse)
library(rmarkdown)
library(stargazer)
library(RDHonest)

New_uber <- New_uber %>% 
  as_tibble() %>%  
  janitor::clean_names() %>% 
  glimpse() 
```



QUESTION:Does uber charge differently based on temperature levels?
Control for: Time of day, trip time, trip type, city, trip start address, trip end address. 
Outcome variable: Rubles per km
Running variable: Temperature value
Cutoff point: 0 degrees celcius




```{r, warning=FALSE, include=FALSE}
New_uber$cutoff=ifelse(New_uber$temperature_value<=0,1,0)
```


```{r, warning=FALSE, include=FALSE}
density <- rddensity(New_uber$temperature_value, c = 0)
rdplotdensity(density, New_uber$temperature_value)

```


```{r, warning=FALSE, include=FALSE}

ggplot(New_uber, aes(x=New_uber$temperature_value))+
  geom_histogram(binwidth=2,fill = 'lightblue', color = 'black')+
  geom_vline(xintercept=0)+
  labs(title = "McCrary Density for Running Variable", x = "Running Variable: Temperature Value", y = "Density")+
  theme_minimal()

```


```{r, warning=FALSE, include=FALSE}
New_uber2 <- New_uber %>%
  mutate(temperature_value_2 = temperature_value - 0)
New_uber2 <- New_uber2 %>%
  filter(temperature_value_2 >=-20 & temperature_value_2 <= 20)
```


```{r, warning=FALSE, include=FALSE}
No_rush_hour <- New_uber %>%
  filter(time_of_day_disc <=10 & time_of_day_disc >=13)
Time_of_day = lm(time_of_day_disc ~ cutoff*temperature_value_2, data=New_uber2)
stargazer(Time_of_day, type = "text")

Trip_time = lm(trip_time_minutes ~ cutoff*temperature_value_2, data=New_uber2)
stargazer(Trip_time, type = "text")

Trip_type= lm(trip_type_dummy ~ cutoff*temperature_value_2, data=New_uber2)
stargazer(Trip_type, type = "text")

City= lm(if_city_sp ~ cutoff*temperature_value_2, data=New_uber2)
stargazer(City, type = "text")

Distance= lm(distance_kms ~ cutoff*temperature_value_2, data=New_uber2)
stargazer(Distance, type = "text")

Exchange_Rate= lm(rub_usd_exchange_rate ~ cutoff*temperature_value_2, data=New_uber2)
stargazer(Exchange_Rate, type = "text")

stargazer(Time_of_day,Trip_time,Trip_type,City,Distance,Exchange_Rate, type = "text")

```

